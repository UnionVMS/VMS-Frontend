<div class="realtime-container">
  <div class="loading-overlay"  *ngIf="!mapReady && !mapSettingsLoaded">
    <h2>Loading asset positions</h2>
    <mat-spinner class="load-spinner"></mat-spinner>
  </div>
  <map-left-column
    [centerMapOnPosition]="centerMapOnPosition"
  ></map-left-column>
  <div class="map-container">
    <div id="realtime-map"></div>
    <ng-container *ngIf="mapReady && mapSettingsLoaded">
      <map-assets
        *ngIf="registerOnSelectFunction !== undefined"
        [assets]="assetMovements"
        [selectedAssets]="selectedAssets$|async"
        [map]="map"
        [mapZoom]="mapZoom"
        [namesVisible]="mapSettings.settings.namesVisible"
        [speedsVisible]="mapSettings.settings.speedsVisible"
        [selectAsset]="selectAsset"
        [deselectAsset]="deselectAsset"
        [shipColorLogic]="mapSettings.settings.assetColorMethod"
        [registerOnSelectFunction]="registerOnSelectFunction"
        [unregisterOnSelectFunction]="unregisterOnSelectFunction"
      ></map-assets>
      <map-tracks-segments
        *ngIf="mapSettings.settings.tracksVisible"
        [assetTracks]="assetTracks$|async"
        [map]="map"
      ></map-tracks-segments>
      <map-tracks
        *ngIf="mapSettings.settings.tracksVisible && mapZoom > 5"
        [assetTracks]="assetTracks$|async"
        [map]="map"
      ></map-tracks>
      <map-flagstates
        *ngIf="mapSettings.settings.flagsVisible && mapZoom > 9 && registerOnSelectFunction !== undefined"
        [assets]="assetMovements"
        [map]="map"
        [selectAsset]="selectAsset"
        [registerOnSelectFunction]="registerOnSelectFunction"
        [unregisterOnSelectFunction]="unregisterOnSelectFunction"
      ></map-flagstates>
      <map-information-panel></map-information-panel>
      <map-asset-forecast
        *ngIf="mapSettings.settings.forecastsVisible && mapZoom > 9"
        [map]="map"
        [assetMovements]="forecasts$|async"
        [forecastInterval]="mapSettings.settings.forecastInterval"
      ></map-asset-forecast>
    </ng-container>
  </div>
  <map-right-column
    [centerMapOnPosition]="centerMapOnPosition"
  ></map-right-column>
  <!-- <map-layer-filter
    [mapSettings]="mapSettings"
    [setVisibilityForAssetNames]="setVisibilityForAssetNames"
    [setVisibilityForAssetSpeeds]="setVisibilityForAssetSpeeds"
    [setVisibilityForFlags]="setVisibilityForFlags"
    [setVisibilityForTracks]="setVisibilityForTracks"
    [setVisibilityForForecast]="setVisibilityForForecast"
    [flagsDisabled]="mapZoom < 10"
    [tracksDisabled]="mapZoom < 10"
    [namesDisabled]="mapZoom < 10"
    [speedsDisabled]="mapZoom < 10"
    [forecastsDisabled]="mapZoom < 10"
    [map]="map"
    [saveViewport]="saveViewport"
  ></map-layer-filter>

  <div class="control-panel">
    <map-control-panel
      *ngIf="mapSettings.currentControlPanel === 'map-control-panel'"
      [mapSettings]="mapSettings"
      [setTracksMinuteCap]="setTracksMinuteCap"
      [setForecastInterval]="setForecastInterval"
      [clearTracks]="clearTracks"
      [clearForecasts]="clearForecasts"
    ></map-control-panel>
    <map-distance-between-points
      *ngIf="map !== undefined"
      [map]="map"
      [registerOnClickFunction]="registerOnClickFunction"
      [active]="mapSettings.currentControlPanel === 'map-distance-between-points'"
    ></map-distance-between-points>
    <map-layers
      *ngIf="(authToken$ | async) !== undefined && (mapLayers$ | async).length > 0"
      [map]="map"
      [authToken]="authToken$ | async"
      [mapLayers]="mapLayers$ | async"
      [activeMapLayers]="activeMapLayers$ | async"
      [menuActive]="mapSettings.currentControlPanel === 'map-layers'"
      [addActiveLayerFunction]="addActiveLayer"
      [removeActiveLayerFunction]="removeActiveLayer"
    ></map-layers>
  </div> -->
</div>
